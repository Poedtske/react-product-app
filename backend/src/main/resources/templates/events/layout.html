<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:insert="~{fragments/head :: head}"></head>

<head>
    <title>Dynamic Event Grid</title>
    <style>
        /* The grid container with 100 columns and 100 rows */
        .event-grid {
            display: grid;
            gap: 10px;
            background-color: white;
            padding: 10px;
            grid-template-columns: repeat(100, 1fr);
            grid-template-rows: repeat(100, 1fr);
        }

        .event-grid-item {
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid black;
            flex-direction: column;
            color: black;
            padding-block: 0.5em;
        }

        /* The sidebar menu */
        .sidebar {
            margin: 0;
            padding: 0;
            width: 200px;
            background-color: #f1f1f1;
            position: fixed;
            top: 0;
            right: 0;
            height: 100%;
            overflow: auto;
            z-index: 1000;
        }

        .sidebar a {
            display: block;
            color: black;
            padding: 16px;
            text-decoration: none;
        }

        .sidebar a.active {
            background-color: #04AA6D;
            color: white;
        }

        .sidebar a:hover:not(.active) {
            background-color: #555;
            color: white;
        }

        div.content {
            margin-left: 200px;
            padding: 1px 16px;
            height: 1000px;
        }

        @media screen and (max-width: 700px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            .sidebar a {float: left;}
            div.content {margin-left: 0;}
        }

        @media screen and (max-width: 400px) {
            .sidebar a {
                text-align: center;
                float: none;
            }
        }
    </style>
</head>

<body>
<nav th:replace="~{fragments/navbar :: nav}"></nav>
<div>
    <h3 th:text="${event.getTitle()}"></h3>
    <h4 th:text="${event.getLocation()}"></h4>

    <div class="event-grid" th:style="|grid-template-columns: repeat(${event.getKolommen()}, 1fr); grid-template-rows: repeat(${event.getKolommen()}, 1fr);|">
        <button type="button" th:each="table, iterStat : ${event.tables}"
                class="event-grid-item"
                th:style="|width: ${table.getWidth()}px; height: ${table.getHeight()}px; margin-top:${table.getMargin(0)};margin-right:${table.getMargin(1)};margin-bottom:${table.getMargin(2)};margin-left:${table.getMargin(3)}; padding-block:${table.getWidth()/4}|"
                onclick="|openUpdateForm(${table.id}, ${table.number}, ${table.seats}, ${table.status})|">
            <span id="tableNr" th:text="'Nr. '+(${iterStat.index + 1})"></span>
            <span id="availableSeats" style="border:solid black 2px;padding-inline:1em;" th:text="(${table.seats - #lists.size(table.tickets)})"></span>
            <p id="seats" style="display: none" th:text="${table.getSeats()}"></p>
        </button>
    </div>
</div>

<!-- Sidebar -->
<div class="sidebar" id="mySidebar" style="display:none">
    <button onclick="w3_close()" class="w3-bar-item w3-large">Close &times;</button>
    <a href="#" class="w3-bar-item w3-button">Link 1</a>
    <a href="#" class="w3-bar-item w3-button">Link 2</a>
    <a href="#" class="w3-bar-item w3-button">Link 3</a>
</div>

<script th:inline="javascript">
    // Function to open the sidebar and populate the form with the clicked table's details
    function openUpdateForm(tableId, tableNumber, seats, status) {
        console.log("Opening form with data:", tableId, tableNumber, seats, status); // Debugging line

        // Ensure the sidebar opens
        document.getElementById('mySidebar').style.display = 'block';

        // Populate the form fields (assuming the form exists in the sidebar)
        document.getElementById('tableId').value = tableId;
        document.getElementById('tableNr').value = tableNumber;
        document.getElementById('seats').value = seats;
        document.getElementById('availableSeats').value = seats;
    }

    // Close sidebar
    function w3_close() {
        document.getElementById("mySidebar").style.display = "none";
    }

</script>

<div th:replace="~{fragments/head :: div.scripts}"></div>

</body>
</html>
